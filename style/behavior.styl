// # Behavior & Animations

$nav-anim-duration = 350ms

translate-right($right)
  transform: translate3d($right * -1,0,0)

// Until https://github.com/visionmedia/nib/pull/95
transition-with-transform($args, $props...)
  unshift($props, unquote("transform") $args)
  for $prefix in webkit moz o ms
    -{$prefix}-transition: s('-%s-%s', $prefix, unquote(join(', ', $props)))


// ## Common Behavior

// We make sure that our major layers are composited so that webkit is ok w/
// all this animation.
document, nav menu
  -webkit-transform: translate3d(0,0,0)


// ## Small Screens

@media (max-width: 550px)
  foo: bar

// ## Medium Screens

@media (min-width: 551px) and (max-width: 901px)
  // Since we don't have enough room to display three columns (`comments`,
  // `code`, `nav`), we opt to go with the pop-over approach.
  sections
    transition-with-transform($nav-anim-duration, "opacity" $nav-anim-duration, right 0ms $nav-anim-duration)
    // By default, faded and zoomed
    opacity:   0.0
    transform: scale(1.1)
    // And also off the edge of the screen to avoid overflowing the body
    right: 300%

  .nav-expanded sections
    transition-with-transform($nav-anim-duration, "opacity" $nav-anim-duration, right 0ms 0ms)
    opacity:   1.0
    transform: scale(1.0)
    right: 0

// ## Large Screens

// If we have enough room, we display the `nav` pane as a third column
// `$commentary-max-width + $nav-min-width`
@media (min-width: 902px)
  // We slide the nav panes in for this three column mode
  sections
    transition-with-transform($nav-anim-duration, right 0ms $nav-anim-duration)
    // By default, `nav` panes are hidden off the edge of the screen
    translate-right: -100%
    // We keep the same right as the medium size to avoid transitions off screen
    right: 300%

  // This kicks in when _hiding_ the nav, it expands immediately as the `nav`
  // pane slides out.
  document
    transition: right 0ms 0ms

  // We constrict the `document`'s width, but after the nav pane has fully slid
  // in.
  .nav-expanded document
    transition: right 0ms $nav-anim-duration
    right: $nav-min-width

  // Slide the panes in.
  .nav-expanded nav sections
    transition-with-transform($nav-anim-duration, right 0ms 0ms)
    translate-right: 0
    right: 0
